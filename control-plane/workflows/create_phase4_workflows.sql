-- Create Phase 4 Agent Workflows: HERMES, ARGUS, ALOY, ATHENA
-- Following CHRONOS pattern

-- HERMES Workflow
INSERT INTO workflow_entity (id, name, active, nodes, connections, settings, "createdAt", "updatedAt", "staticData", "triggerCount", "versionId")
VALUES (
    'HERMES001Phase4',
    'HERMES - Notifications',
    true,
    '[{"name":"HERMES Webhook","type":"n8n-nodes-base.webhook","position":[208,304],"webhookId":"hermes-webhook","parameters":{"path":"hermes","options":{},"httpMethod":"POST","responseMode":"responseNode"},"typeVersion":2,"id":"hermes-wh-001"},{"name":"HERMES Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[464,304],"parameters":{"text":"={{ $json.body.message || $json.body.chatInput || $json.body.query || JSON.stringify($json.body) }}","options":{"systemMessage":"You are HERMES, the Notification & Approval agent for the LeverEdge control plane.\n\nYour responsibilities:\n- Send notifications to various channels\n- Request human approval for tier 2/3 operations\n- Track pending approvals\n- Report on notification history\n\nYou have tools to check health, send notifications, request approvals, list pending approvals, and get history.\n\nAlways be concise. Report what you did and the result."},"promptType":"define"},"typeVersion":1.7,"id":"hermes-agent-001"},{"name":"Claude Sonnet","type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","position":[336,512],"parameters":{"model":"claude-sonnet-4-20250514","options":{"maxTokensToSample":4096}},"typeVersion":1.2,"id":"hermes-llm-001","credentials":{"anthropicApi":{"id":"NQ4e9Jw74TK8ABhU","name":"Anthropic account"}}},{"name":"Log to Event Bus","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[480,512],"parameters":{"url":"http://event-bus:8099/events","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"source_agent\": \"HERMES\", \"action\": \"{{ $fromAI(''action'', ''Action performed'') }}\", \"details\": {\"message\": \"{{ $fromAI(''details'', ''Details'') }}\"}}","description":"Log an event to the Event Bus"},"typeVersion":1.1,"id":"hermes-log-001"},{"name":"HERMES Health","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[624,512],"parameters":{"url":"http://hermes:8014/health","description":"Check HERMES backend health"},"typeVersion":1.1,"id":"hermes-health-001"},{"name":"Send Notification","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[768,512],"parameters":{"url":"http://hermes:8014/notify","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"channel\": \"{{ $fromAI(''channel'', ''event-bus'') }}\", \"message\": \"{{ $fromAI(''message'', ''Notification'') }}\", \"priority\": \"{{ $fromAI(''priority'', ''normal'') }}\"}","description":"Send notification. Channels: event-bus, telegram, slack. Priority: low, normal, high, critical."},"typeVersion":1.1,"id":"hermes-notify-001"},{"name":"Request Approval","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[912,512],"parameters":{"url":"http://hermes:8014/request-approval","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"action\": \"{{ $fromAI(''action_desc'', ''Action to approve'') }}\", \"source_agent\": \"{{ $fromAI(''source_agent'', ''AGENT'') }}\", \"tier\": {{ $fromAI(''tier'', ''2'') }}, \"details\": {}}","description":"Request human approval for an action. Returns approval_id."},"typeVersion":1.1,"id":"hermes-approve-001"},{"name":"List Pending","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[1056,512],"parameters":{"url":"http://hermes:8014/pending","description":"List pending approval requests"},"typeVersion":1.1,"id":"hermes-pending-001"},{"name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","position":[704,304],"parameters":{"options":{},"respondWith":"text","responseBody":"={{ $json.output }}"},"typeVersion":1.1,"id":"hermes-resp-001"}]',
    '{"HERMES Webhook":{"main":[[{"node":"HERMES Agent","type":"main","index":0}]]},"HERMES Agent":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Claude Sonnet":{"ai_languageModel":[[{"node":"HERMES Agent","type":"ai_languageModel","index":0}]]},"Log to Event Bus":{"ai_tool":[[{"node":"HERMES Agent","type":"ai_tool","index":0}]]},"HERMES Health":{"ai_tool":[[{"node":"HERMES Agent","type":"ai_tool","index":0}]]},"Send Notification":{"ai_tool":[[{"node":"HERMES Agent","type":"ai_tool","index":0}]]},"Request Approval":{"ai_tool":[[{"node":"HERMES Agent","type":"ai_tool","index":0}]]},"List Pending":{"ai_tool":[[{"node":"HERMES Agent","type":"ai_tool","index":0}]]}}',
    '{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","availableInMCP":false}',
    NOW(),
    NOW(),
    NULL,
    0,
    'hermes-v1-001'
);

-- ARGUS Workflow
INSERT INTO workflow_entity (id, name, active, nodes, connections, settings, "createdAt", "updatedAt", "staticData", "triggerCount", "versionId")
VALUES (
    'ARGUS001Phase4x',
    'ARGUS - Observability',
    true,
    '[{"name":"ARGUS Webhook","type":"n8n-nodes-base.webhook","position":[208,304],"webhookId":"argus-webhook","parameters":{"path":"argus","options":{},"httpMethod":"POST","responseMode":"responseNode"},"typeVersion":2,"id":"argus-wh-001"},{"name":"ARGUS Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[464,304],"parameters":{"text":"={{ $json.body.message || $json.body.chatInput || $json.body.query || JSON.stringify($json.body) }}","options":{"systemMessage":"You are ARGUS, the Observability agent for the LeverEdge control plane.\n\nYour responsibilities:\n- Monitor system and agent health\n- Query Prometheus metrics\n- Report on service status\n- Alert on issues\n\nYou have tools to check health, get system status, agent status, metrics, query Prometheus, and create alerts.\n\nAlways be concise. Report status clearly and highlight any issues."},"promptType":"define"},"typeVersion":1.7,"id":"argus-agent-001"},{"name":"Claude Sonnet","type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","position":[336,512],"parameters":{"model":"claude-sonnet-4-20250514","options":{"maxTokensToSample":4096}},"typeVersion":1.2,"id":"argus-llm-001","credentials":{"anthropicApi":{"id":"NQ4e9Jw74TK8ABhU","name":"Anthropic account"}}},{"name":"Log to Event Bus","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[480,512],"parameters":{"url":"http://event-bus:8099/events","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"source_agent\": \"ARGUS\", \"action\": \"{{ $fromAI(''action'', ''Action performed'') }}\", \"details\": {\"message\": \"{{ $fromAI(''details'', ''Details'') }}\"}}","description":"Log an event to the Event Bus"},"typeVersion":1.1,"id":"argus-log-001"},{"name":"ARGUS Health","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[624,512],"parameters":{"url":"http://argus:8016/health","description":"Check ARGUS backend health"},"typeVersion":1.1,"id":"argus-health-001"},{"name":"System Status","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[768,512],"parameters":{"url":"http://argus:8016/status","description":"Get overall system status including all agents"},"typeVersion":1.1,"id":"argus-status-001"},{"name":"Get Metrics","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[912,512],"parameters":{"url":"http://argus:8016/metrics","description":"Get current system metrics"},"typeVersion":1.1,"id":"argus-metrics-001"},{"name":"Create Alert","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[1056,512],"parameters":{"url":"http://argus:8016/alert","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"severity\": \"{{ $fromAI(''severity'', ''warning'') }}\", \"source\": \"{{ $fromAI(''source'', ''ARGUS'') }}\", \"message\": \"{{ $fromAI(''alert_message'', ''Alert'') }}\"}","description":"Create an alert. Severity: info, warning, error, critical."},"typeVersion":1.1,"id":"argus-alert-001"},{"name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","position":[704,304],"parameters":{"options":{},"respondWith":"text","responseBody":"={{ $json.output }}"},"typeVersion":1.1,"id":"argus-resp-001"}]',
    '{"ARGUS Webhook":{"main":[[{"node":"ARGUS Agent","type":"main","index":0}]]},"ARGUS Agent":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Claude Sonnet":{"ai_languageModel":[[{"node":"ARGUS Agent","type":"ai_languageModel","index":0}]]},"Log to Event Bus":{"ai_tool":[[{"node":"ARGUS Agent","type":"ai_tool","index":0}]]},"ARGUS Health":{"ai_tool":[[{"node":"ARGUS Agent","type":"ai_tool","index":0}]]},"System Status":{"ai_tool":[[{"node":"ARGUS Agent","type":"ai_tool","index":0}]]},"Get Metrics":{"ai_tool":[[{"node":"ARGUS Agent","type":"ai_tool","index":0}]]},"Create Alert":{"ai_tool":[[{"node":"ARGUS Agent","type":"ai_tool","index":0}]]}}',
    '{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","availableInMCP":false}',
    NOW(),
    NOW(),
    NULL,
    0,
    'argus-v1-001'
);

-- ALOY Workflow
INSERT INTO workflow_entity (id, name, active, nodes, connections, settings, "createdAt", "updatedAt", "staticData", "triggerCount", "versionId")
VALUES (
    'ALOY0001Phase4x',
    'ALOY - Audit & Anomaly',
    true,
    '[{"name":"ALOY Webhook","type":"n8n-nodes-base.webhook","position":[208,304],"webhookId":"aloy-webhook","parameters":{"path":"aloy","options":{},"httpMethod":"POST","responseMode":"responseNode"},"typeVersion":2,"id":"aloy-wh-001"},{"name":"ALOY Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[464,304],"parameters":{"text":"={{ $json.body.message || $json.body.chatInput || $json.body.query || JSON.stringify($json.body) }}","options":{"systemMessage":"You are ALOY, the Audit & Anomaly Detection agent for the LeverEdge control plane.\n\nYour responsibilities:\n- Query and report on audit logs\n- Detect anomalies in system behavior\n- Analyze patterns in events\n- Generate security reports\n\nYou have tools to check health, get recent audit events, generate audit reports, list anomalies, analyze patterns, and get detection rules.\n\nAlways be concise. Report findings clearly and flag any security concerns."},"promptType":"define"},"typeVersion":1.7,"id":"aloy-agent-001"},{"name":"Claude Sonnet","type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","position":[336,512],"parameters":{"model":"claude-sonnet-4-20250514","options":{"maxTokensToSample":4096}},"typeVersion":1.2,"id":"aloy-llm-001","credentials":{"anthropicApi":{"id":"NQ4e9Jw74TK8ABhU","name":"Anthropic account"}}},{"name":"Log to Event Bus","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[480,512],"parameters":{"url":"http://event-bus:8099/events","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"source_agent\": \"ALOY\", \"action\": \"{{ $fromAI(''action'', ''Action performed'') }}\", \"details\": {\"message\": \"{{ $fromAI(''details'', ''Details'') }}\"}}","description":"Log an event to the Event Bus"},"typeVersion":1.1,"id":"aloy-log-001"},{"name":"ALOY Health","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[624,512],"parameters":{"url":"http://aloy:8015/health","description":"Check ALOY backend health"},"typeVersion":1.1,"id":"aloy-health-001"},{"name":"Recent Audit Events","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[768,512],"parameters":{"url":"http://aloy:8015/audit/recent","description":"Get recent audit events from Event Bus"},"typeVersion":1.1,"id":"aloy-recent-001"},{"name":"Audit Report","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[912,512],"parameters":{"url":"http://aloy:8015/audit/report","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"hours\": {{ $fromAI(''hours'', ''24'') }}}","description":"Generate an audit report for the specified number of hours"},"typeVersion":1.1,"id":"aloy-report-001"},{"name":"List Anomalies","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[1056,512],"parameters":{"url":"http://aloy:8015/anomalies","description":"List detected anomalies"},"typeVersion":1.1,"id":"aloy-anomalies-001"},{"name":"Analyze Patterns","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[1200,512],"parameters":{"url":"http://aloy:8015/analyze","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"focus\": \"{{ $fromAI(''focus'', ''all'') }}\"}","description":"Analyze event patterns. Focus: all, security, performance, errors."},"typeVersion":1.1,"id":"aloy-analyze-001"},{"name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","position":[704,304],"parameters":{"options":{},"respondWith":"text","responseBody":"={{ $json.output }}"},"typeVersion":1.1,"id":"aloy-resp-001"}]',
    '{"ALOY Webhook":{"main":[[{"node":"ALOY Agent","type":"main","index":0}]]},"ALOY Agent":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Claude Sonnet":{"ai_languageModel":[[{"node":"ALOY Agent","type":"ai_languageModel","index":0}]]},"Log to Event Bus":{"ai_tool":[[{"node":"ALOY Agent","type":"ai_tool","index":0}]]},"ALOY Health":{"ai_tool":[[{"node":"ALOY Agent","type":"ai_tool","index":0}]]},"Recent Audit Events":{"ai_tool":[[{"node":"ALOY Agent","type":"ai_tool","index":0}]]},"Audit Report":{"ai_tool":[[{"node":"ALOY Agent","type":"ai_tool","index":0}]]},"List Anomalies":{"ai_tool":[[{"node":"ALOY Agent","type":"ai_tool","index":0}]]},"Analyze Patterns":{"ai_tool":[[{"node":"ALOY Agent","type":"ai_tool","index":0}]]}}',
    '{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","availableInMCP":false}',
    NOW(),
    NOW(),
    NULL,
    0,
    'aloy-v1-001'
);

-- ATHENA Workflow
INSERT INTO workflow_entity (id, name, active, nodes, connections, settings, "createdAt", "updatedAt", "staticData", "triggerCount", "versionId")
VALUES (
    'ATHENA01Phase4',
    'ATHENA - Documentation',
    true,
    '[{"name":"ATHENA Webhook","type":"n8n-nodes-base.webhook","position":[208,304],"webhookId":"athena-webhook","parameters":{"path":"athena","options":{},"httpMethod":"POST","responseMode":"responseNode"},"typeVersion":2,"id":"athena-wh-001"},{"name":"ATHENA Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[464,304],"parameters":{"text":"={{ $json.body.message || $json.body.chatInput || $json.body.query || JSON.stringify($json.body) }}","options":{"systemMessage":"You are ATHENA, the Documentation agent for the LeverEdge control plane.\n\nYour responsibilities:\n- Generate system documentation\n- Create architecture diagrams\n- Maintain documentation freshness\n- Update specific docs on request\n\nYou have tools to check health, generate reports, generate architecture docs, list docs, get specific documents, and update documents.\n\nAlways be concise. Focus on accuracy and clarity in documentation."},"promptType":"define"},"typeVersion":1.7,"id":"athena-agent-001"},{"name":"Claude Sonnet","type":"@n8n/n8n-nodes-langchain.lmChatAnthropic","position":[336,512],"parameters":{"model":"claude-sonnet-4-20250514","options":{"maxTokensToSample":4096}},"typeVersion":1.2,"id":"athena-llm-001","credentials":{"anthropicApi":{"id":"NQ4e9Jw74TK8ABhU","name":"Anthropic account"}}},{"name":"Log to Event Bus","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[480,512],"parameters":{"url":"http://event-bus:8099/events","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"source_agent\": \"ATHENA\", \"action\": \"{{ $fromAI(''action'', ''Action performed'') }}\", \"details\": {\"message\": \"{{ $fromAI(''details'', ''Details'') }}\"}}","description":"Log an event to the Event Bus"},"typeVersion":1.1,"id":"athena-log-001"},{"name":"ATHENA Health","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[624,512],"parameters":{"url":"http://athena:8013/health","description":"Check ATHENA backend health"},"typeVersion":1.1,"id":"athena-health-001"},{"name":"Generate Report","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[768,512],"parameters":{"url":"http://athena:8013/generate/report","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"report_type\": \"{{ $fromAI(''report_type'', ''status'') }}\", \"scope\": \"{{ $fromAI(''scope'', ''all'') }}\"}","description":"Generate a report. Types: status, health, deployment. Scope: all, agents, workflows."},"typeVersion":1.1,"id":"athena-report-001"},{"name":"Generate Architecture","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[912,512],"parameters":{"url":"http://athena:8013/generate/architecture","method":"POST","sendBody":true,"specifyBody":"json","jsonBody":"={\"format\": \"{{ $fromAI(''format'', ''markdown'') }}\"}","description":"Generate architecture documentation. Format: markdown, mermaid, json."},"typeVersion":1.1,"id":"athena-arch-001"},{"name":"List Docs","type":"@n8n/n8n-nodes-langchain.toolHttpRequest","position":[1056,512],"parameters":{"url":"http://athena:8013/docs","description":"List all available documentation"},"typeVersion":1.1,"id":"athena-list-001"},{"name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","position":[704,304],"parameters":{"options":{},"respondWith":"text","responseBody":"={{ $json.output }}"},"typeVersion":1.1,"id":"athena-resp-001"}]',
    '{"ATHENA Webhook":{"main":[[{"node":"ATHENA Agent","type":"main","index":0}]]},"ATHENA Agent":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Claude Sonnet":{"ai_languageModel":[[{"node":"ATHENA Agent","type":"ai_languageModel","index":0}]]},"Log to Event Bus":{"ai_tool":[[{"node":"ATHENA Agent","type":"ai_tool","index":0}]]},"ATHENA Health":{"ai_tool":[[{"node":"ATHENA Agent","type":"ai_tool","index":0}]]},"Generate Report":{"ai_tool":[[{"node":"ATHENA Agent","type":"ai_tool","index":0}]]},"Generate Architecture":{"ai_tool":[[{"node":"ATHENA Agent","type":"ai_tool","index":0}]]},"List Docs":{"ai_tool":[[{"node":"ATHENA Agent","type":"ai_tool","index":0}]]}}',
    '{"executionOrder":"v1","callerPolicy":"workflowsFromSameOwner","availableInMCP":false}',
    NOW(),
    NOW(),
    NULL,
    0,
    'athena-v1-001'
);
