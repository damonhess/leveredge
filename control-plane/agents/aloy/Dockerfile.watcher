FROM python:3.11-slim

WORKDIR /app

# Install docker CLI for log checking and database queries
RUN apt-get update && apt-get install -y \
    docker.io \
    && rm -rf /var/lib/apt/lists/*

RUN pip install --no-cache-dir httpx

# Create shared modules directory (will be mounted at runtime)
RUN mkdir -p /opt/leveredge/control-plane/shared

COPY aloy_watcher.py .

CMD ["python", "aloy_watcher.py"]
